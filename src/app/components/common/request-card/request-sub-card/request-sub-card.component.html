<p-tabView *ngIf="mode ">

  <p-tabPanel header="DESCRIPCION">
    <div class="row ">
      <div class="col-8 anchoColumn ">
        <p class="destacado">
          {{ taskSub.description }}
        </p>
      </div>
      <div class="col-3 ">
        <div *ngIf="!taskSub.photoNewTaskArray[0]" class="photo-profile " fxFlex="row" fxLayoutAlign="center center"
          style="
            background-size: cover;
            background-position: center center;
            flex: none;
          " [style.background-image]="
            getSafeImage('../../../assets/img/noImage.png')
          ">
        </div>
        <div *ngIf="taskSub.photoNewTaskArray[0]" class="photo-profile" fxFlex="row" fxLayoutAlign="center center"
          (click)="displayBasic2 = true" style="
          background-size: cover;
          background-position: center center;
          flex: none;" [style.background-image]="getSafeImage(taskSub.photoNewTaskArray[0])">
          <button id="photoCameraBtn" style="position: absolute">
            <h2 style="color:white;">{{numberPhoto}}</h2>
          </button>
        </div>
      </div>
    </div>
  </p-tabPanel>

  <p-tabPanel header="DIRECCION">
    <div class="row ">
      <div class="col-8 anchoColumn">
        <p class="destacado">
          {{ taskSub.address.street }}, {{ taskSub.address.number }}<br>
          Portal {{ taskSub.address.portal }}, Escalera {{ taskSub.address.stair }}, Planta {{ taskSub.address.floor }},
          Puerta {{ taskSub.address.door }}, Codigo Postal {{ taskSub.address.cp }}
        </p>
      </div>

      <div class="col-3 align-self-center">
        <div class="location-btn " style="text-align: center;">
          <button pButton pRipple type="button" icon="fas fa-map-marker-alt" class="p-button-rounded p-button-warning"
            pTooltip="Google Maps" tooltipPosition="right"></button>
        </div>
      </div>
    </div>
  </p-tabPanel>

</p-tabView>

<p-tabView *ngIf="!mode && role == 'provider'">
  <div class="container">
    <div class="row " style="background-color: #f6b776; height: 60px;">

      <div class="col-sm " style="border-right: 1px solid black; height: 60px; text-align: center;">
        <h6 class="mt-4" style="font-family: Arial, Helvetica, sans-serif; font-weight: bold; ">SERVICIO</h6>
      </div>
      <div class="col-sm " style="text-align: center; ">
        <h6 class="mt-4" style="font-family: Arial, Helvetica, sans-serif; font-weight: bold;">PRECIO</h6>
      </div>
    </div>
  </div>

  <div class="list-group" fxLayout="column" fxLayoutAlign="space-around center" style="background-color: white">
    <div class="list-group-item list-group-item-action  p-2" fxLayout="row" fxLayoutAlign="space-around center" style="
          background-color: white;
          border-bottom: 2px solid #f6b776 ;
          width: 95%;
          color: black;
          
        ">
      <h6 fxFlex="50" style="
            
            height: 20px;
            margin-bottom: 0;
            margin-left: 50px;
            font-weight: normal;
                        
          ">
        Mano de Obra
      </h6>
      <input type="number" placeholder="Valor en €" fxFlex="50" style="height: 20px; border: none; text-align: center"
        [(ngModel)]="workforce" (keyup)="onKeyUpWorkForce()" />
    </div>

    <div class="row" *ngIf="workForceInvalid">
      <div class="col-sm-12" style="left: 200px;">
        <small class="p-invalid">Mano de obra no valido.</small>
      </div>

    </div>

    <ng-container *ngIf="!taskSub.require_materials">
      <div class="list-group-item list-group-item-action p-2" fxLayout="row" fxLayoutAlign="space-around center" style="
          background-color: white;
          border-bottom: 2px solid #f6b776;
          color: black;
          width: 95%;

          
        ">
        <h6 fxFlex="50" style="
            
        height: 20px;
        margin-bottom: 0;
        margin-left: 50px;
        font-weight: normal;
                    
      ">
          Materiales
        </h6>
        <input type="number" placeholder="Valor en €" fxFlex="50" style="height: 20px; border: none; text-align: center"
          [(ngModel)]="materials" (keyup)="onKeyUpMaterial()" />

      </div>
    </ng-container>

    <div class="row" *ngIf="materialInvalid">
      <div class="col-sm-12" style="left: 200px;">
        <small class="p-invalid">Material no valido.</small>
      </div>
    </div>

    <div class="list-group-item list-group-item-action  p-2" fxLayout="row" fxLayoutAlign="space-around center" style="
          background-color: white;
          border-bottom: 2px solid #f6b776 ;
          width: 95%;
          color: black;
          
        ">
      <h6 fxFlex="50" style="
            
            height: 20px;
            margin-bottom: 0;
            margin-left: 50px;
            font-weight: normal;
                        
          ">
        TOTAL
      </h6>
      <h6 class="m-0" fxFlex="50" style="  font-weight: normal; height: 20px; border: none; text-align: center">
        {{total}}</h6>
    </div>

    <button class="btn btn-primary btn-sm mt-4 mb-4" style="color: black" (click)='sendPresupuesto()'
      [disabled]="materialInvalid==true || workForceInvalid==true || disableEnviarM == true || disableEnviarW == true">ENVIAR</button>

  </div>

</p-tabView>


<div class="list-group" *ngIf="!mode && role == 'client'" fxLayout="column" fxLayoutAlign="space-around center">
  <ng-container *ngIf="offersList">
    <div class="list-group-item list-group-item-action" fxLayout="row" fxLayoutAlign="space-around center"
      *ngFor="let offer of offersList">
      <div *ngIf="offer.photoProvider" class="img-container" fxFlex="10" (click)="onClickOffer(offer)" style="
      background-size: cover;
      background-position: center center;
      flex: none;
      " [style.background-image]="
      getSafeImage(offer.photoProvider)"> </div>
      <div *ngIf="!offer.photoProvider" class="img-container" fxFlex="10" (click)="onClickOffer(offer)" style="
      background-size: cover;
      background-position: center center;
      flex: none;
    " [style.background-image]="
      getSafeImage('../../../assets/img/noImage.png')
    ">
      </div>
      <h5 class="name" fxFlex="15" fxFlexOffset="1" (click)="displayModal = !displayModal">
        {{ offer.provider_name }}
      </h5>
      <p-rating [ngModel]="offer.ranking" readonly="true" stars="5" [cancel]="false" fxFlex="20" fxFlexOffset="8"
        class="mb-2" style="pointer-events: none;"></p-rating>
      <div class="chat-button" fxLayout="column" fxFlexOffset="15" fxLayoutAlign="space-around center"
        (click)="goToChat(offer.id)">
        <i class="far fa-comment-alt"></i>
        <span>Chat</span>
      </div>
      <div class="chat-button" fxLayout="column" fxFlexOffset="5" fxLayoutAlign="space-around center"
        (click)="acceptOffer(offer.id)">
        <i class="fas fa-check-square"></i>
        <span>Aceptar</span>
      </div>
      <div class="chat-button" fxLayout="column" fxFlexOffset="2" fxLayoutAlign="space-around center"
        (click)="cancelOffer(offer.id)">
        <i class="fas fa-window-close"></i>
        <span>Cancelar</span>
      </div>
      <h2 fxFlexOffset="5">{{ offer.budget }}€</h2>
    </div>
  </ng-container>
</div>


<p-galleria [(value)]="images" [(visible)]="displayBasic2" [containerStyle]="{'max-width': '850px'}" [numVisible]="7"
  [circular]="true" [fullScreen]="true" [showItemNavigators]="true" [showThumbnails]="false" [baseZIndex]="100000">
  <ng-template pTemplate="item" let-item>
    <img [src]="item.previewImageSrc" style="width: 100%; display: block;" />
  </ng-template>

</p-galleria>

<p-dialog header=" " [(visible)]="displayModal" [modal]="true" [baseZIndex]="10000" [draggable]="false">

  <div fxLayout="row">
    <div class="name-container" fxLayout="column" fxFlexOffset="10">
      <h2 class="name">{{currentOffer?.provider_name}}</h2>
      <h4 class="job"> FONTANERA</h4>
      <p-rating [ngModel]="currentOffer?.ranking" readonly="true" stars="5" [cancel]="false" fxFlex="20"
        fxFlexAlign="center" fxFlexOffset="10" class="mb-2 w-100" style="pointer-events: none;"></p-rating>
    </div>
  </div>


</p-dialog>